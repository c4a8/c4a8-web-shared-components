import{_ as I,p as j,Q as N,E as L,W as $,X as O}from"./CV0-TAqy.js";import{u as R,q as P}from"./CajngY8W.js";const k={tagName:"markdown-files",computed:{structuredList(){var y,w,q;const e=[];if(!this.list)return;const t=(y=this.query)==null?void 0:y.limitEvents,o=(w=this.query)==null?void 0:w.reversed,n=((q=this.query)==null?void 0:q.sort[0])||this.sort,b="de";let p=0;for(const r of this.list){const{seo:d,path:m,date:f,moment:g,_dir:_,hideInRecent:v,webcast:u,meta:s,...a}=r;if(this.isRecent&&(v||_==="events"&&u!==!0))continue;if(_==="events"&&t!==void 0){if(p>=t)continue;p++}const l=Object.keys({...a,...s}).filter(x=>!this.hideData.includes(x)).reduce((x,D)=>(x[D]=(s==null?void 0:s[D])||a[D],x),{}),i=this.cleanDate(this.isDate(g)?g:f||this.extractDate(m)),h=i||"2000-01-01",c={url:m,date:h,moment:h,excerpt:s.customExcerpt||(d==null?void 0:d.description),...l};typeof c.lang!="string"&&(c.lang=b),c.url=this.addPathPrefix(m,c.lang,this.strategy),!(this.hideItems&&this.hideItems(c))&&e.push(c)}if(n){const[r,d]=Object.entries(n)[0];e.sort((m,f)=>m[r]<f[r]?d===-1?1:-1:m[r]>f[r]?d===-1?-1:1:0)}if(this.limit){const r=t?this.limit+t:this.limit;return o?e.slice(-r):e.slice(0,r)}return e}},methods:{addPathPrefix(e,t,o){return o==="prefix"?`/${t}${e}`:e},extractDate(e){return e?this.getDate(e):null},getDate(e){const t=/\d{4}-\d{2}-\d{2}/,o=e.match(t);return o?o[0]:null},isDate(e){return e?this.getDate(e)!==null:null},cleanDate(e){return typeof e=="string"&&e.includes("T")?e.split("T")[0]:e}},props:{list:Array,hideData:{type:Array,default:()=>[]},sort:Object,limit:Number,query:Object,isRecent:Boolean,hideItems:{type:Function,default:null},strategy:{type:String}}};function C(e,t,o,n,b,p){return j(e.$slots,"default",{files:p.structuredList})}const F=I(k,[["render",C]]);k.__docgenInfo={exportName:"default",displayName:"markdown-files",description:"",tags:{},props:[{name:"list",type:{name:"array"}},{name:"hideData",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"sort",type:{name:"object"}},{name:"limit",type:{name:"number"}},{name:"query",type:{name:"object"}},{name:"isRecent",type:{name:"boolean"}},{name:"hideItems",type:{name:"func"},defaultValue:{func:!1,value:"null"}},{name:"strategy",type:{name:"string"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"files",title:"binding"}]}],sourceFiles:["/home/runner/work/c4a8-web-shared-components/c4a8-web-shared-components/nuxt-storybook-test/components/markdown-files.vue"]};const E={__name:"shared-content-list",props:{query:{type:Object,required:!0},dataList:{type:Array,default:()=>[]}},async setup(e){var g,_,v;let t,o;const n=e,{locale:b,strategy:p}=N(),y=L(()=>({...n.query,where:{...n.query.where}})),w=((g=n.query)==null?void 0:g.key)||((v=(_=n.query)==null?void 0:_.path)==null?void 0:v.replace("/","content-"))||"content-list",q=u=>{const s=new Map;return u.filter(a=>{var i;const l=(i=a.path)==null?void 0:i.replace(/-(en|es)(\.md)?$/,"");return l?s.has(l)?!1:(s.set(l,!0),!0):!0})},r=u=>{let a=P(u);return y.value.where&&Object.keys(y.value.where).length>0&&Object.entries(y.value.where).forEach(([l,i])=>{typeof i=="object"?Object.entries(i).forEach(([h,c])=>{a=a.where(l,h,c)}):a=a.where(l,"=",i)}),a},d=L(()=>n.dataList.length>0?n.dataList:null),{data:m}=([t,o]=$(async()=>R(w,async()=>{var i;if(n.dataList.length>0)return null;const u="content_"+b.value,s=await r(u).all();if(!((i=n.query.additionalCollections)!=null&&i.length))return s;const a=await Promise.all(n.query.additionalCollections.map(async h=>r(h).all())),l=[...s,...a.flat()];return q(l)},"$ld9N_z5-Np")),t=await t,o(),t),f=L(()=>d.value||m.value);return(u,s)=>j(u.$slots,"default",{list:f.value,strategy:O(p)})}};E.__docgenInfo={exportName:"default",displayName:"shared-content-list",description:"",tags:{},props:[{name:"query",type:{name:"object"},required:!0},{name:"dataList",type:{name:"array"},defaultValue:{func:!1,value:"[]"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"list",title:"binding"},{name:"strategy",title:"binding"}]}],sourceFiles:["/home/runner/work/c4a8-web-shared-components/c4a8-web-shared-components/nuxt-storybook-test/components/shared-content-list.vue"]};export{E as _,F as a};
