var g=Object.defineProperty;var m=(h,t,s)=>t in h?g(h,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[t]=s;var l=(h,t,s)=>m(h,typeof t!="symbol"?t+"":t,s);import{W as c,S as e,T as a}from"./B3N1L4ua.js";class d{constructor(t){this.root=t,this.root.nodeType===Node.ELEMENT_NODE&&(this.setOffsets(),this.setMarginTop(),this.firstChild=document.querySelector("main > *:first-child"),this.isUpdating=!1,this.maxPercentage=100,this.lastPercentage=!1,this.header=document.querySelector("header"),this.headerSpacer=document.querySelector(".header__spacer"),this.main=document.querySelector("main"),this.setup(),this.bindEvents(),this.setStickyPosition())}bindEvents(){window.addEventListener("scroll",this.handleScroll.bind(this)),document.addEventListener(c.WINDOW_RESIZE,this.handleResize.bind(this)),document.addEventListener(c.DIMENSIONS_CHANGED,this.handleDimensionsChanged.bind(this))}addDebugPositions(){this.topPosition=document.createElement("div"),this.bottomPosition=document.createElement("div");const t=document.querySelector("main");t.appendChild(this.topPosition),t.appendChild(this.bottomPosition),this.bottomPosition.style.position=this.topPosition.style.position="absolute",this.bottomPosition.style.boxSizing="content-box",this.bottomPosition.style.left=this.topPosition.style.left=0,this.bottomPosition.style.width=this.topPosition.style.width="30px",this.bottomPosition.style.height=this.topPosition.style.height="2px",this.bottomPosition.style.backgroundColor="rgba(255, 255, 0, 1)",this.bottomPosition.style.border="1px solid rgb(0, 0, 0)",this.topPosition.style.backgroundColor="rgba(255, 0, 0, 1)",this.bottomPosition.style.zIndex=this.topPosition.style.zIndex=1e3,this.bottomPosition.style.pointerEvents=this.topPosition.style.pointerEvents="none",this.updateDebugPositions()}updateDebugPositions(){!this.topPosition||!this.bottomPosition||(this.topPosition.style.top=(this.calculatedOffsetTop||this.currentTopPosition)+"px",this.bottomPosition.style.top=(this.calculatedOffsetBottom||this.currentBottomPosition)+"px")}setMarginTop(){this.marginTop=parseInt(window.getComputedStyle(this.root).marginTop.replace("px",""),10)}handleDimensionsChanged(t){t.detail===this.root&&this.handleResize()}setOffsets(){this.offsetTop=this.root.offsetTop,this.offsetBottom=this.offsetTop+this.root.offsetHeight}handleResize(){this.resetElements(),this.setOffsets(),this.setDimensions(),this.setPositions(),this.setStickyPosition()}handleScroll(){this.isUpdating||(this.isUpdating=!0,window.requestAnimationFrame(this.setStickyPosition.bind(this)))}getHeaderHeight(){var t,s;return this.isHeaderSticky()?((s=this.headerSpacer)==null?void 0:s.offsetHeight)||0:((t=this.header)==null?void 0:t.offsetHeight)||0}isHeaderSticky(){if(!this.header)return!1;const t=window.getComputedStyle(this.header);return t.position==="fixed"||t.position==="absolute"||t.position==="sticky"}updateClipPath(t){const s="inset(0% 0% "+t+"%)";this.root.style.clipPath=s,this.isUpdating=!1}isFirstChild(t){return this.firstChild===t}isSticky(){return this.root.classList.contains(e.STICKY)}setPositions(){this.setTopPosition(),this.setBottomPosition()}setTopPosition(){this.currentTopPosition=this.root.offsetTop}setBottomPosition(){this.currentBottomPosition=this.root.offsetTop+this.root.offsetHeight}getMainOffsetTop(){var t;return((t=this.main)==null?void 0:t.offsetTop)||0}getPercentage(t,s){this.calculatedOffsetTop=this.currentTopPosition-s-this.marginTop+this.getMainOffsetTop(),this.calculatedOffsetBottom=this.currentBottomPosition-s+this.getMainOffsetTop(),this.marginTop<0&&(this.calculatedOffsetBottom-=this.marginTop);let i=t,n;if(this.calculatedOffsetBottom>=i){let o=this.root.offsetHeight/100;this.calculatedOffsetTop<0?n=i/o:n=(i-this.calculatedOffsetTop)/o}else n=this.maxPercentage;return parseFloat(n.toFixed(2))}isOutOfViewport(t){return t>=this.maxPercentage||t<0}setStickyPosition(){const t=this.getHeaderHeight(),s=window.scrollY,i=this.root.offsetHeight-window.innerHeight,n=i>0?this.offsetBottom:this.offsetBottom-t;let o=i>0?-i:0;o=o-this.marginTop;const r=this.getPercentage(s,o),p=this.isOutOfViewport(r),f=s>n-window.innerHeight;!p&&f?(this.spacer.style.height||(this.fixScrollPosition=!0,this.spacer.style.marginTop=this.marginTop+"px",this.spacer.style.height=this.height+"px",this.root.style.width=this.spacer.style.width=this.width+"px",this.root.style.height=this.height+"px",this.root.style.left="50%",this.root.style.transform="translateX(-50%)"),this.root.style.top=o+"px",this.root.classList.remove(e.OFF_SCREEN),this.root.classList.add(e.STICKY),this.updateClipPath(r)):r===0?(this.isUpdating=!1,this.root.classList.remove(e.OFF_SCREEN)):this.disableStickyness(),this.updateDebugPositions()}disableStickyness(){this.root.classList.remove(e.STICKY),this.root.classList.add(e.OFF_SCREEN),this.root.style.top="",this.root.style.clipPath="",this.root.style.width="",this.root.style.height="",this.spacer.style.height="",this.spacer.style.marginTop="",this.root.style.left="",this.root.style.transform="",this.isUpdating=!1}setup(){const t=this.root.parentNode;this.spacer=document.createElement("div"),t&&(this.spacer.classList.add("sticky-scroller__spacer"),this.setDimensions(),t.insertBefore(this.spacer,this.root.nextSibling),this.root.dataset.stickyScroller=!0,this.setPositions(),this.setNextElementColor())}hasBackground(){return this.root.classList.contains(e.HAS_BACKGROUND)||a.getElementBgColor(this.root)}setNextElementColor(){if(!this.hasBackground())return;const t=this.spacer.nextSibling,s="--color-sticky-scroller";if(!t||t.nodeType!==Node.ELEMENT_NODE)return;const i=a.getElementBgColor(t)||a.getElementBgColor(t.firstChild);this.spacer.style.setProperty(s,i),this.spacer.classList.add(e.HAS_BACKGROUND)}setDimensions(){const t=document.body.getBoundingClientRect().width;this.width=this.root.clientWidth>t?t:this.root.clientWidth,this.height=this.root.clientHeight,this.spacer.style.width=this.width+"px"}resetElements(){this.root.style.top="",this.spacer.style.marginTop="",this.root.style.height=this.root.style.width=this.spacer.style.width=this.spacer.style.height="",this.root.style.clipPath="",this.root.classList.remove(e.STICKY)}static init(t){this.instances=[],[].forEach.call(t||document.querySelectorAll(this.rootSelector),s=>{this.instances.push(new this(s))})}static getRootClass(){return this.rootSelector.substring(1)}}l(d,"rootSelector",".is-sticky-scroller"),l(d,"instances",[]);export{d as S};
