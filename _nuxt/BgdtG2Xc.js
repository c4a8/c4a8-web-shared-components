import{_ as N,h as j,R as $,E as L,W as O,X as R}from"./BnmIKFE7.js";import{u as k,q as P}from"./CY_pedWX.js";const I={tagName:"markdown-files",computed:{structuredList(){var h,w,q;const e=[];if(!this.list)return;const t=(h=this.query)==null?void 0:h.limitEvents,l=(w=this.query)==null?void 0:w.reversed,n=((q=this.query)==null?void 0:q.sort[0])||this.sort,b="de";let p=0;for(const r of this.list){const{seo:d,path:m,date:f,moment:g,_dir:_,hideInRecent:v,webcast:u,meta:s,...a}=r;if(this.isRecent&&(v||_==="events"&&u!==!0))continue;if(_==="events"&&t!==void 0){if(p>=t)continue;p++}const o=Object.keys({...a,...s}).filter(x=>!this.hideData.includes(x)).reduce((x,D)=>(x[D]=(s==null?void 0:s[D])||a[D],x),{}),i=this.cleanDate(this.isDate(g)?g:f||this.extractDate(m)),y=i||"2000-01-01",c={url:m,date:y,moment:y,excerpt:s.customExcerpt||(d==null?void 0:d.description),...o};typeof c.lang!="string"&&(c.lang=b),c.url=this.addPathPrefix(m,c.lang,this.strategy),!(this.hideItems&&this.hideItems(c))&&e.push(c)}if(n){const[r,d]=Object.entries(n)[0];e.sort((m,f)=>m[r]<f[r]?d===-1?1:-1:m[r]>f[r]?d===-1?-1:1:0)}if(this.limit){const r=t?this.limit+t:this.limit;return l?e.slice(-r):e.slice(0,r)}return e}},methods:{addPathPrefix(e,t,l){return l==="prefix"?`/${t}${e}`:e},extractDate(e){return e?this.getDate(e):null},getDate(e){const t=/\d{4}-\d{2}-\d{2}/,l=e.match(t);return l?l[0]:null},isDate(e){return e?this.getDate(e)!==null:null},cleanDate(e){return typeof e=="string"&&e.includes("T")?e.split("T")[0]:e}},props:{list:Array,hideData:{type:Array,default:()=>[]},sort:Object,limit:Number,query:Object,isRecent:Boolean,hideItems:{type:Function,default:null},strategy:{type:String}}};function C(e,t,l,n,b,p){return j(e.$slots,"default",{files:p.structuredList})}const F=N(I,[["render",C]]);I.__docgenInfo={exportName:"default",displayName:"markdown-files",description:"",tags:{},props:[{name:"list",type:{name:"array"}},{name:"hideData",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"sort",type:{name:"object"}},{name:"limit",type:{name:"number"}},{name:"query",type:{name:"object"}},{name:"isRecent",type:{name:"boolean"}},{name:"hideItems",type:{name:"func"},defaultValue:{func:!1,value:"null"}},{name:"strategy",type:{name:"string"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"files",title:"binding"}]}],sourceFiles:["/home/runner/work/c4a8-web-shared-components/c4a8-web-shared-components/nuxt/components/markdown-files.vue"]};const E={__name:"shared-content-list",props:{query:{type:Object,required:!0},dataList:{type:Array,default:()=>[]}},async setup(e){var g,_,v;let t,l;const n=e,{locale:b,strategy:p}=$(),h=L(()=>({...n.query,where:{...n.query.where}})),w=((g=n.query)==null?void 0:g.key)||((v=(_=n.query)==null?void 0:_.path)==null?void 0:v.replace("/","content-"))||"content-list",q=u=>{const s=new Map;return u.filter(a=>{var i;const o=(i=a.path)==null?void 0:i.replace(/-(en|es)(\.md)?$/,"");return o?s.has(o)?!1:(s.set(o,!0),!0):!0})},r=u=>{let a=P(u);return h.value.where&&Object.keys(h.value.where).length>0&&Object.entries(h.value.where).forEach(([o,i])=>{typeof i=="object"?Object.entries(i).forEach(([y,c])=>{a=a.where(o,y,c)}):a=a.where(o,"=",i)}),a},d=L(()=>n.dataList.length>0?n.dataList:null),{data:m}=([t,l]=O(async()=>k(w,async()=>{var i;if(n.dataList.length>0)return null;const u="content_"+b.value,s=await r(u).all();if(!((i=n.query.additionalCollections)!=null&&i.length))return s;const a=await Promise.all(n.query.additionalCollections.map(async y=>r(y).all())),o=[...s,...a.flat()];return q(o)},"$ld9N_z5-Np")),t=await t,l(),t),f=L(()=>d.value||m.value);return(u,s)=>j(u.$slots,"default",{list:f.value,strategy:R(p)})}};E.__docgenInfo={exportName:"default",displayName:"shared-content-list",description:"",tags:{},props:[{name:"query",type:{name:"object"},required:!0},{name:"dataList",type:{name:"array"},defaultValue:{func:!1,value:"[]"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"list",title:"binding"},{name:"strategy",title:"binding"}]}],sourceFiles:["/home/runner/work/c4a8-web-shared-components/c4a8-web-shared-components/nuxt/components/shared-content-list.vue"]};export{E as _,F as a};
