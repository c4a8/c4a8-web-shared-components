import{_ as I,h as L,R as N,E as D,W as $,X as R}from"./Bad3uSeb.js";import{u as O,q as k}from"./B43wCnTS.js";const j={tagName:"markdown-files",computed:{structuredList(){var y,w,q;const e=[];if(!this.list)return;const t=(y=this.query)==null?void 0:y.limitEvents,l=(w=this.query)==null?void 0:w.reversed,n=((q=this.query)==null?void 0:q.sort[0])||this.sort,b="de";let h=0;for(const r of this.list){const{seo:d,path:m,date:f,moment:g,_dir:_,hideInRecent:v,webcast:c,meta:s,...a}=r;if(this.isRecent&&(v||_==="events"&&c!==!0))continue;if(_==="events"&&t!==void 0){if(h>=t)continue;h++}const o=Object.keys({...a,...s}).filter(p=>!this.hideData.includes(p)).reduce((p,x)=>(p[x]=(s==null?void 0:s[x])||a[x],p),{}),i=this.cleanDate(this.isDate(g)?g:f||this.extractDate(m)),u={url:m,date:i,moment:i,excerpt:s.customExcerpt||(d==null?void 0:d.description),...o};typeof u.lang!="string"&&(u.lang=b),u.url=this.addPathPrefix(m,u.lang,this.strategy),!(this.hideItems&&this.hideItems(u))&&e.push(u)}if(n){const[r,d]=Object.entries(n)[0];e.sort((m,f)=>m[r]<f[r]?d===-1?1:-1:m[r]>f[r]?d===-1?-1:1:0)}if(this.limit){const r=t?this.limit+t:this.limit;return l?e.slice(-r):e.slice(0,r)}return e}},methods:{addPathPrefix(e,t,l){return l==="prefix"?`/${t}${e}`:e},extractDate(e){return e?this.getDate(e):null},getDate(e){const t=/\d{4}-\d{2}-\d{2}/,l=e.match(t);return l?l[0]:null},isDate(e){return e?this.getDate(e)!==null:null},cleanDate(e){return typeof e=="string"&&e.includes("T")?e.split("T")[0]:e}},props:{list:Array,hideData:{type:Array,default:()=>[]},sort:Object,limit:Number,query:Object,isRecent:Boolean,hideItems:{type:Function,default:null},strategy:{type:String}}};function P(e,t,l,n,b,h){return L(e.$slots,"default",{files:h.structuredList})}const V=I(j,[["render",P]]);j.__docgenInfo={exportName:"default",displayName:"markdown-files",description:"",tags:{},props:[{name:"list",type:{name:"array"}},{name:"hideData",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"sort",type:{name:"object"}},{name:"limit",type:{name:"number"}},{name:"query",type:{name:"object"}},{name:"isRecent",type:{name:"boolean"}},{name:"hideItems",type:{name:"func"},defaultValue:{func:!1,value:"null"}},{name:"strategy",type:{name:"string"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"files",title:"binding"}]}],sourceFiles:["/home/runner/work/c4a8-web-shared-components/c4a8-web-shared-components/nuxt/components/markdown-files.vue"]};const C={__name:"shared-content-list",props:{query:{type:Object,required:!0},dataList:{type:Array,default:()=>[]}},async setup(e){var g,_,v;let t,l;const n=e,{locale:b,strategy:h}=N(),y=D(()=>({...n.query,where:{...n.query.where}})),w=((g=n.query)==null?void 0:g.key)||((v=(_=n.query)==null?void 0:_.path)==null?void 0:v.replace("/","content-"))||"content-list",q=c=>{const s=new Map;return c.filter(a=>{var i;const o=(i=a.path)==null?void 0:i.replace(/-(en|es)(\.md)?$/,"");return o?s.has(o)?!1:(s.set(o,!0),!0):!0})},r=c=>{let a=k(c);return y.value.where&&Object.keys(y.value.where).length>0&&Object.entries(y.value.where).forEach(([o,i])=>{typeof i=="object"?Object.entries(i).forEach(([u,p])=>{a=a.where(o,u,p)}):a=a.where(o,"=",i)}),a},d=D(()=>n.dataList.length>0?n.dataList:null),{data:m}=([t,l]=$(async()=>O(w,async()=>{var i;if(n.dataList.length>0)return null;const c="content_"+b.value,s=await r(c).all();if(!((i=n.query.additionalCollections)!=null&&i.length))return s;const a=await Promise.all(n.query.additionalCollections.map(async u=>r(u).all())),o=[...s,...a.flat()];return q(o)},"$ld9N_z5-Np")),t=await t,l(),t),f=D(()=>d.value||m.value);return(c,s)=>L(c.$slots,"default",{list:f.value,strategy:R(h)})}};C.__docgenInfo={exportName:"default",displayName:"shared-content-list",description:"",tags:{},props:[{name:"query",type:{name:"object"},required:!0},{name:"dataList",type:{name:"array"},defaultValue:{func:!1,value:"[]"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"list",title:"binding"},{name:"strategy",title:"binding"}]}],sourceFiles:["/home/runner/work/c4a8-web-shared-components/c4a8-web-shared-components/nuxt/components/shared-content-list.vue"]};export{C as _,V as a};
